define(["jquery","theme_boost/tooltip"],function(a,b){var c={errors:[],warnings:[]},d={parseRgb:function(a){var b,c,d,e,f;if(c=a.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(d=c.slice(1,4),b=e=0;e<=2;b=++e)d[b]=+d[b];d[3]=1}else if(c=a.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(d=c.slice(1,5),b=f=0;f<=3;b=++f)d[b]=+d[b];return d},contrastRatio:function(a,b){var c=d.relativeLuminance(d.parseRgb(a)),e=d.relativeLuminance(d.parseRgb(b));return(Math.max(c,e)+.05)/(Math.min(c,e)+.05)},relativeLuminance:function(a){for(var b=[],c=0;c<3;c++){var d=a[c]/255;b.push(d<.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))}return.2126*b[0]+.7152*b[1]+.0722*b[2]},getBackground:function(a){var b=getComputedStyle(a),c=b.backgroundColor,e=b.backgroundImage;return"rgba(0, 0, 0, 0)"!==c&&"transparent"!==c&&"none"===e?c:"none"!==e?"image":"HTML"===a.tagName?"rgb(255, 255, 255)":d.getBackground(a.parentNode)},isVisible:function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},check:function(){for(var a=document.getElementById("check-wcag").querySelectorAll("*"),b=0;b<a.length;b++)!function(b){var e=a[b];if(d.isVisible(e)){var f,g,h,i=getComputedStyle(e),j=i.color,k=i.fill,l=e.tagName,m=d.getBackground(e),n=[].reduce.call(e.childNodes,function(a,b){return a+(3===b.nodeType?b.textContent:"")},""),o=n.trim();if("svg"===l){var p=Math.round(100*d.contrastRatio(k,m))/100,q=p+":1";p<3&&(h="true",g="svg fill",f="fail")}else if(o.length)if("image"===m)f="Needs manual review",g="N/A",h=!0;else{var p=Math.round(100*d.contrastRatio(j,m))/100,q=p+":1",r=parseInt(i.fontSize),s=i.fontWeight;r>=18||r>=14&&s>=700?(g="large scale text",p<3?(f="fail",h=!0):(f="pass",h=!1)):(g="normal body text",p<4.5?(f="fail",h=!0):(f="pass",h=!1))}if(h){var t={};t={name:e,ratio:q,detail:g,status:f},"fail"===f?c.errors.push(t):"Needs manual review"===f&&c.warnings.push(t)}}}(b);return c}},e=function(b){container=a("#check-wcag"),container.on("click",function(){d.check(),a("div.errors").html(""),a("div.warnings").html(""),a("div.errors").append('<h3 class="error-highlight">Errors</h3>'),a("div.warnings").append('<h3 class="warning-highlight">Warnings</h3>'),a("div.errors, div.warnings").append("<ol></ol>");for(var b=0;b<c.errors.length;b++){var e=c.errors[b];a(e.name).addClass("error-highlight").append(" ("+b+")"),a("div.errors ol").append("<li>"+e.name.innerHTML+": "+e.ratio+"</li>")}for(var b=0;b<c.warnings.length;b++){var e=c.warnings[b];a(e.name).addClass("error-highlight").append(" ("+b+")"),a("div.warnings ol").append("<li>"+e.name.innerHTML+": "+e.ratio+"</li>")}}),a(".hastooltip").tooltip({boundary:"window"})};return{init:e}});